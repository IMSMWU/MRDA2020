<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2020</title>
  <meta name="description" content="An Introduction to Data Analytics Using R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2020" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to Data Analytics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2020" />
  
  <meta name="twitter:description" content="An Introduction to Data Analytics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="regression.html"/>
<link rel="next" href="introduction-to-r-markdown.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/d3-3.5.2/d3.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-2.2.1/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.5/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.5/js/ggvis.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">MRDA 2020</a></strong></li>
<li class="divider"></li>
<li class="part"><span><b>I Course outline</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html"><i class="fa fa-check"></i>Course structure</a><ul>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html#schedule"><i class="fa fa-check"></i>Schedule</a><ul>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html#lecture-notes-qa"><i class="fa fa-check"></i>Lecture notes Q&amp;A</a></li>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html#group-project"><i class="fa fa-check"></i>Group project</a></li>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html#individual-assignments"><i class="fa fa-check"></i>Individual assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="course-structure.html"><a href="course-structure.html#grading"><i class="fa fa-check"></i>Grading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html"><i class="fa fa-check"></i>Course materials</a><ul>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#datacamp"><i class="fa fa-check"></i>DataCamp</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>II Lecture notes</b></span></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#to-explain-or-to-predict"><i class="fa fa-check"></i><b>1.1</b> To explain or to predict</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#holdout-testing"><i class="fa fa-check"></i><b>1.2</b> Holdout testing</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.2</b> Getting help</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#a-typical-r-session"><i class="fa fa-check"></i><b>2.5</b> A typical R session</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>3</b> Data handling</a><ul>
<li class="chapter" data-level="3.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>3.1</b> Basic data handling</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>3.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>3.1.2</b> Data types</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>3.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>3.2</b> Data import and export</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>3.2.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-handling.html"><a href="data-handling.html#import-data-created-by-other-software-packages"><i class="fa fa-check"></i><b>3.2.2</b> Import data created by other software packages</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>3.2.3</b> Export data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-handling.html"><a href="data-handling.html#import-data-from-the-web"><i class="fa fa-check"></i><b>3.2.4</b> Import data from the Web</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing data</a><ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-statistics"><i class="fa fa-check"></i><b>4.1</b> Summary statistics</a><ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>4.1.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>4.1.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>4.2</b> Data visualization</a><ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>4.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>4.2.2</b> Continuous variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#saving-plots"><i class="fa fa-check"></i><b>4.2.3</b> Saving plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#additional-options"><i class="fa fa-check"></i><b>4.2.4</b> Additional options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Introduction to Statistical Inference</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>5.1</b> If we knew it all</a><ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>5.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>5.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>5.3</b> Using what we actually know</a><ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>5.3.1</b> Confidence Intervals for the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#summary"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>6</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-null-hypothesis"><i class="fa fa-check"></i><b>6.1.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="6.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>6.1.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="6.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#choosing-the-right-test"><i class="fa fa-check"></i><b>6.1.3</b> Choosing the right test</a></li>
<li class="chapter" data-level="6.1.4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#summary"><i class="fa fa-check"></i><b>6.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>6.2</b> One sample t-test</a></li>
<li class="chapter" data-level="6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-two-means"><i class="fa fa-check"></i><b>6.3</b> Comparing two means</a><ul>
<li class="chapter" data-level="6.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#independent-means-t-test"><i class="fa fa-check"></i><b>6.3.1</b> Independent-means t-test</a></li>
<li class="chapter" data-level="6.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#dependent-means-t-test"><i class="fa fa-check"></i><b>6.3.2</b> Dependent-means t-test</a></li>
<li class="chapter" data-level="6.3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#further-considerations"><i class="fa fa-check"></i><b>6.3.3</b> Further considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-several-means"><i class="fa fa-check"></i><b>6.4</b> Comparing several means</a><ul>
<li class="chapter" data-level="6.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>6.4.1</b> Introduction</a></li>
<li class="chapter" data-level="6.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#decomposing-variance"><i class="fa fa-check"></i><b>6.4.2</b> Decomposing variance</a></li>
<li class="chapter" data-level="6.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-way-anova"><i class="fa fa-check"></i><b>6.4.3</b> One-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>6.5</b> Non-parametric tests</a><ul>
<li class="chapter" data-level="6.5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#mann-whitney-u-test-a.k.a.-wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>6.5.1</b> Mann-Whitney U Test (a.k.a. Wilcoxon rank-sum test)</a></li>
<li class="chapter" data-level="6.5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>6.5.2</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="6.5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>6.5.3</b> Kruskal-Wallis test</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#categorical-data"><i class="fa fa-check"></i><b>6.6</b> Categorical data</a><ul>
<li class="chapter" data-level="6.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>6.6.1</b> Confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test"><i class="fa fa-check"></i><b>6.6.2</b> Chi-square test</a></li>
<li class="chapter" data-level="6.6.3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#sample-size"><i class="fa fa-check"></i><b>6.6.3</b> Sample size</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#summary-of-hypothesis-testing"><i class="fa fa-check"></i><b>6.7</b> Summary of hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>7</b> Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="regression.html"><a href="regression.html#correlation"><i class="fa fa-check"></i><b>7.1</b> Correlation</a><ul>
<li class="chapter" data-level="7.1.1" data-path="regression.html"><a href="regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>7.1.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="7.1.2" data-path="regression.html"><a href="regression.html#significance-testing"><i class="fa fa-check"></i><b>7.1.2</b> Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>7.2</b> Regression</a><ul>
<li class="chapter" data-level="7.2.1" data-path="regression.html"><a href="regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.2.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.2.2" data-path="regression.html"><a href="regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.2.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="regression.html"><a href="regression.html#potential-problems"><i class="fa fa-check"></i><b>7.3</b> Potential problems</a><ul>
<li class="chapter" data-level="7.3.1" data-path="regression.html"><a href="regression.html#outliers"><i class="fa fa-check"></i><b>7.3.1</b> Outliers</a></li>
<li class="chapter" data-level="7.3.2" data-path="regression.html"><a href="regression.html#influential-observations"><i class="fa fa-check"></i><b>7.3.2</b> Influential observations</a></li>
<li class="chapter" data-level="7.3.3" data-path="regression.html"><a href="regression.html#non-linearity"><i class="fa fa-check"></i><b>7.3.3</b> Non-linearity</a></li>
<li class="chapter" data-level="7.3.4" data-path="regression.html"><a href="regression.html#non-constant-error-variance"><i class="fa fa-check"></i><b>7.3.4</b> Non-constant error variance</a></li>
<li class="chapter" data-level="7.3.5" data-path="regression.html"><a href="regression.html#non-normally-distributed-errors"><i class="fa fa-check"></i><b>7.3.5</b> Non-normally distributed errors</a></li>
<li class="chapter" data-level="7.3.6" data-path="regression.html"><a href="regression.html#correlation-of-errors"><i class="fa fa-check"></i><b>7.3.6</b> Correlation of errors</a></li>
<li class="chapter" data-level="7.3.7" data-path="regression.html"><a href="regression.html#collinearity"><i class="fa fa-check"></i><b>7.3.7</b> Collinearity</a></li>
<li class="chapter" data-level="7.3.8" data-path="regression.html"><a href="regression.html#omitted-variables"><i class="fa fa-check"></i><b>7.3.8</b> Omitted Variables</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regression.html"><a href="regression.html#categorical-predictors"><i class="fa fa-check"></i><b>7.4</b> Categorical predictors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="regression.html"><a href="regression.html#two-categories"><i class="fa fa-check"></i><b>7.4.1</b> Two categories</a></li>
<li class="chapter" data-level="7.4.2" data-path="regression.html"><a href="regression.html#more-than-two-categories"><i class="fa fa-check"></i><b>7.4.2</b> More than two categories</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regression.html"><a href="regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>7.5</b> Extensions of the linear model</a><ul>
<li class="chapter" data-level="7.5.1" data-path="regression.html"><a href="regression.html#interaction-effects"><i class="fa fa-check"></i><b>7.5.1</b> Interaction effects</a></li>
<li class="chapter" data-level="7.5.2" data-path="regression.html"><a href="regression.html#non-linear-relationships"><i class="fa fa-check"></i><b>7.5.2</b> Non-linear relationships</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="regression.html"><a href="regression.html#summary-of-regression"><i class="fa fa-check"></i><b>7.6</b> Summary of regression</a></li>
<li class="chapter" data-level="7.7" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>7.7</b> Logistic regression</a><ul>
<li class="chapter" data-level="7.7.1" data-path="regression.html"><a href="regression.html#motivation-and-intuition"><i class="fa fa-check"></i><b>7.7.1</b> Motivation and intuition</a></li>
<li class="chapter" data-level="7.7.2" data-path="regression.html"><a href="regression.html#technical-details-of-the-model"><i class="fa fa-check"></i><b>7.7.2</b> Technical details of the model</a></li>
<li class="chapter" data-level="7.7.3" data-path="regression.html"><a href="regression.html#estimation-in-r"><i class="fa fa-check"></i><b>7.7.3</b> Estimation in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html"><i class="fa fa-check"></i><b>8</b> Exploratory factor analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>8.2</b> Steps in factor analysis</a><ul>
<li class="chapter" data-level="8.2.1" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#are-the-assumptions-satisfied"><i class="fa fa-check"></i><b>8.2.1</b> Are the assumptions satisfied?</a></li>
<li class="chapter" data-level="8.2.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#deriving-factors"><i class="fa fa-check"></i><b>8.2.2</b> Deriving factors</a></li>
<li class="chapter" data-level="8.2.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#factor-interpretation"><i class="fa fa-check"></i><b>8.2.3</b> Factor interpretation</a></li>
<li class="chapter" data-level="8.2.4" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#creating-new-variables"><i class="fa fa-check"></i><b>8.2.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#reliability-analysis"><i class="fa fa-check"></i><b>8.3</b> Reliability analysis</a></li>
<li class="chapter" data-level="8.4" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#summary-of-factor-analysis"><i class="fa fa-check"></i><b>8.4</b> Summary of factor analysis</a></li>
</ul></li>
<li class="part"><span><b>III Assignments</b></span></li>
<li class="chapter" data-level="9" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html"><i class="fa fa-check"></i><b>9</b> Introduction to R Markdown</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i>Creating a new R Markdown document</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#text-and-equations"><i class="fa fa-check"></i>Text and Equations</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#headings"><i class="fa fa-check"></i>Headings</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#lists"><i class="fa fa-check"></i>Lists</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#text-formatting"><i class="fa fa-check"></i>Text formatting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#r-code"><i class="fa fa-check"></i>R-Code</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#global-and-chunk-options"><i class="fa fa-check"></i>Global and chunk options</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#latex-math"><i class="fa fa-check"></i>LaTeX Math</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#important-symbols"><i class="fa fa-check"></i>Important symbols</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#greek-letters"><i class="fa fa-check"></i>Greek letters</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Group project</b></span></li>
<li class="chapter" data-level="10" data-path="questionnaire-design.html"><a href="questionnaire-design.html"><i class="fa fa-check"></i><b>10</b> Questionnaire design</a><ul>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#questionnaire-design-process"><i class="fa fa-check"></i>Questionnaire design process</a><ul>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#specification-of-the-information-needed"><i class="fa fa-check"></i>Specification of the information needed</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#specify-the-interviewing-method"><i class="fa fa-check"></i>Specify the interviewing method</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#determine-the-content-of-questions"><i class="fa fa-check"></i>Determine the content of questions</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#inability-and-unwillingness-to-answer"><i class="fa fa-check"></i>Inability and unwillingness to answer</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#decide-on-measurement-scales-and-scaling-techniques"><i class="fa fa-check"></i>Decide on measurement scales and scaling techniques</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#questionnaire-structure"><i class="fa fa-check"></i>Questionnaire structure</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#question-wording"><i class="fa fa-check"></i>Question wording</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#choose-adequate-order"><i class="fa fa-check"></i>Choose adequate order</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#test-your-questionnaire"><i class="fa fa-check"></i>Test your questionnaire</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#questionnaire-in-qualtrics"><i class="fa fa-check"></i>Questionnaire in Qualtrics</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#question-types-and-data-analysis"><i class="fa fa-check"></i>Question types and data analysis</a><ul>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#multiple-choice-with-a-single-answer"><i class="fa fa-check"></i>Multiple choice with a single answer</a></li>
<li class="chapter" data-level="10.0.1" data-path="questionnaire-design.html"><a href="questionnaire-design.html#multiple-choice-with-multiple-answers"><i class="fa fa-check"></i><b>10.0.1</b> Multiple choice with multiple answers</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#rank-order-question"><i class="fa fa-check"></i>Rank order question</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#constant-sum-question"><i class="fa fa-check"></i>Constant Sum question</a></li>
<li class="chapter" data-level="" data-path="questionnaire-design.html"><a href="questionnaire-design.html#text-or-number-entry-question"><i class="fa fa-check"></i>Text or number entry question</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing Research Design &amp; Analysis 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploratory-factor-analysis" class="section level1">
<h1><span class="header-section-number">8</span> Exploratory factor analysis</h1>
<p>This chapter is primarily based on</p>
<ul>
<li>Field, A., Miles J., &amp; Field, Z. (2012): Discovering Statistics Using R. Sage Publications, <strong>chapter 17</strong></li>
<li>Malhotra, N. K.(2010). Marketing Research: An Applied Orientation (6th. ed.). Prentice Hall. <strong>chapter 19</strong></li>
</ul>
<p><a href="./Code/12-pca.R">You can download the corresponding R-Code here</a></p>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>In this chapter, we will focus on exploratory factor analysis.</p>
<p>Generally, factor analysis is a class of procedures used for data reduction or summarization. It is an <strong>interdependence technique</strong>, meaning that there is
no distinction between dependent and independent variables and all variables are considered simultaneously. In <strong>exploratory factor analysis</strong>, specific hypotheses about how many factors will emerge, and what items these factors will comprise are not requires (as opposed to confirmatory factor analysis). Principal Components Analysis (PCA) is one of the most frequently used techniques. The goals are …</p>
<ul>
<li>To identify underlying dimensions, or factors, that explain the correlations among a set of variables</li>
<li>To identify a new, smaller set of uncorrelated variables to replace the original set of correlated variables in subsequent multivariate analysis (e.g., regression analysis, t-test, etc.)</li>
</ul>
<p>To see what this means, let’s use a simple example. Say, you wanted to explain the motives underlying the purchasing of toothpaste. You come up with six items that represent different motives of purchasing toothpaste:</p>
<ul>
<li><strong>Item 1</strong>: It is important to buy toothpaste that prevents cavities.</li>
<li><strong>Item 2</strong>: I like a toothpaste that gives shiny teeth.</li>
<li><strong>Item 3</strong>: A toothpaste should strengthen your gums.</li>
<li><strong>Item 4</strong>: I prefer a toothpaste that freshens breath.</li>
<li><strong>Item 5</strong>: Prevention of tooth decay should not be an important benefit offered by a toothpaste.</li>
<li><strong>Item 6</strong>: The most important consideration in buying a toothpaste is attractive teeth.</li>
</ul>
<p>Let’s assume you collect data from 30 respondents and you use 7-point itemized rating scales to measure the extent of agreement to each of these statements. This is the data that you have collected:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="exploratory-factor-analysis.html#cb572-1"></a>factor_analysis &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/Teaching/master/MRDA2017/toothpaste.dat&quot;</span>, </span>
<span id="cb572-2"><a href="exploratory-factor-analysis.html#cb572-2"></a>                          <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, </span>
<span id="cb572-3"><a href="exploratory-factor-analysis.html#cb572-3"></a>                          <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co">#read in data</span></span>
<span id="cb572-4"><a href="exploratory-factor-analysis.html#cb572-4"></a><span class="kw">str</span>(factor_analysis) <span class="co">#inspect data</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	30 obs. of  6 variables:
##  $ prevent_cavities: int  7 1 6 4 1 6 5 6 3 2 ...
##  $ shiny_teeth     : int  3 3 2 5 2 3 3 4 4 6 ...
##  $ strengthen_gum  : int  6 2 7 4 2 6 6 7 2 2 ...
##  $ fresh_breath    : int  4 4 4 6 3 4 3 4 3 6 ...
##  $ prevent_decay   : int  6 3 7 6 2 6 4 7 2 1 ...
##  $ attract_teeth   : int  4 4 3 5 2 4 3 4 3 6 ...</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="exploratory-factor-analysis.html#cb574-1"></a><span class="kw">head</span>(factor_analysis) <span class="co">#inspect data</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prevent_cavities"],"name":[1],"type":["int"],"align":["right"]},{"label":["shiny_teeth"],"name":[2],"type":["int"],"align":["right"]},{"label":["strengthen_gum"],"name":[3],"type":["int"],"align":["right"]},{"label":["fresh_breath"],"name":[4],"type":["int"],"align":["right"]},{"label":["prevent_decay"],"name":[5],"type":["int"],"align":["right"]},{"label":["attract_teeth"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"7","2":"3","3":"6","4":"4","5":"6","6":"4"},{"1":"1","2":"3","3":"2","4":"4","5":"3","6":"4"},{"1":"6","2":"2","3":"7","4":"4","5":"7","6":"3"},{"1":"4","2":"5","3":"4","4":"6","5":"6","6":"5"},{"1":"1","2":"2","3":"2","4":"3","5":"2","6":"2"},{"1":"6","2":"3","3":"6","4":"4","5":"6","6":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><br></p>
<p>A <strong>construct</strong> is a specific type of concept that exists at a higher level of abstraction than everyday concepts. In this example, the <em>perceived benefits</em> of toothpaste represent the construct that we would like to measure. The construct is unobservable (‘latent’) but it can be inferred from other measurable variables (items) that together comprise a scale (latent construct). A <strong>multi-item scale</strong> consists of multiple items, where an item is a single question or statement to be evaluated. In the above example, we use six items to measure the perceived benefits of toothpaste. If several items correlate highly, they might measure aspects of a common underlying dimension (a.k.a. factors). That is, specific patterns in the correlation matrix signal the existence of one or more factors underlying the data. Let’s inspect the correlation matrix using the <code>rcorr()</code> function from the <code>Hmisc</code> package.</p>
<p><br></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="exploratory-factor-analysis.html#cb575-1"></a><span class="kw">library</span>(<span class="st">&quot;Hmisc&quot;</span>)</span>
<span id="cb575-2"><a href="exploratory-factor-analysis.html#cb575-2"></a><span class="kw">rcorr</span>(<span class="kw">as.matrix</span>(factor_analysis))</span></code></pre></div>
<pre><code>##                  prevent_cavities shiny_teeth strengthen_gum fresh_breath
## prevent_cavities             1.00       -0.05           0.87        -0.09
## shiny_teeth                 -0.05        1.00          -0.16         0.57
## strengthen_gum               0.87       -0.16           1.00        -0.25
## fresh_breath                -0.09        0.57          -0.25         1.00
## prevent_decay                0.86       -0.02           0.78         0.01
## attract_teeth                0.00        0.64          -0.02         0.64
##                  prevent_decay attract_teeth
## prevent_cavities          0.86          0.00
## shiny_teeth              -0.02          0.64
## strengthen_gum            0.78         -0.02
## fresh_breath              0.01          0.64
## prevent_decay             1.00          0.14
## attract_teeth             0.14          1.00
## 
## n= 30 
## 
## 
## P
##                  prevent_cavities shiny_teeth strengthen_gum fresh_breath
## prevent_cavities                  0.7800      0.0000         0.6508      
## shiny_teeth      0.7800                       0.4134         0.0010      
## strengthen_gum   0.0000           0.4134                     0.1868      
## fresh_breath     0.6508           0.0010      0.1868                     
## prevent_decay    0.0000           0.9175      0.0000         0.9725      
## attract_teeth    0.9826           0.0001      0.9245         0.0001      
##                  prevent_decay attract_teeth
## prevent_cavities 0.0000        0.9826       
## shiny_teeth      0.9175        0.0001       
## strengthen_gum   0.0000        0.9245       
## fresh_breath     0.9725        0.0001       
## prevent_decay                  0.4723       
## attract_teeth    0.4723</code></pre>
<p><br></p>
<p>You can see that some of the items correlate highly, while others don’t. Specifically, there appear to be two groups of items that correlate highly and that might represent underlying dimensions of the construct:</p>
<ul>
<li>Factor 1: Items 1, 3, 5</li>
<li>Factor 2: Items 2, 4, 6</li>
</ul>
<p>Going back to the specific wording of the items you can see that the first group of items (i.e., items 1,3,5) refer to the <strong>health benefits</strong>, while the second item group (i.e., items 2,4,6) refer to the <strong>social benefits</strong>. Imagine now, for example, you would like to include the above variables as explanatory variables in a regression model. Due to the high degree of correlation among the items, you are likely to run into problems of multicollinearity. Instead of omitting some of the items, you might try to combine highly correlated items into one variable. Another application could be when you are developing a new measurement scale for a construct and you wish to explore the underlying dimensions of this construct. In these applications, you need to make sure that the questions that you are asking actually relate to the construct that you intend to measure.</p>
<p>The goal of factor analysis is to explain the maximum amount of total variance in a correlation matrix by transforming the original variables into linear components. This means that the correlation matrix is broken down into a smaller set of dimensions. The generalized formal representation of the linear relationship between a latent factor <em>Y</em> and the set of variables can be written as:</p>
<p><span class="math display" id="eq:factor1">\[\begin{equation} 
Y_i=b_1X_{1i} + b_2X_{2i} + b_nX_{ni}+\epsilon_i
\tag{8.1}
\end{equation}\]</span></p>
<p>where X<sub>n</sub> represents the data that we have collected for the different variables. To make it more explicit, the equation could also be written as</p>
<p><span class="math display" id="eq:factor2">\[\begin{equation} 
Factor_i=b_1Variable_{1i} + b_2Variable_{2i} + b_nVariable_{ni}+\epsilon_i
\tag{8.2}
\end{equation}\]</span></p>
<p>where the dependent variable “Factor” refers to the factor score of person <em>i</em> on the underlying dimensions. In our case, the initial inspection suggested two underlying factors (i.e., health benefits and social benefits), so that we can construct two equations that describe both factors in terms of the variables that we have measured:</p>
<p><span class="math display" id="eq:factor3">\[\begin{equation} 
Health_i=b_1X_{1i} + b_2X_{2i} + b_3X_{3i}+ b_4X_{4i}+ b_5X_{5i}+ b_6X_{6i}+\epsilon_i
\tag{8.3}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:factor4">\[\begin{equation} 
Social_i=b_1X_{1i} + b_2X_{2i} + b_3X_{3i}+ b_4X_{4i}+ b_5X_{5i}+ b_6X_{6i}+\epsilon_i
\tag{8.4}
\end{equation}\]</span></p>
<p>where the b’s in each equation represent the <strong>factor loadings</strong>. You can see that both equations include the same set of predictors. However, their values in each equation will be different, depending on the importance of each variable to the respective factor. Once the factor loadings have been computed (we will see how this is done below), we can summarize them in a component matrix, which is usually denoted as <code>A</code>:</p>
<p><span class="math display">\[\mathbf{A} = \left[\begin{array}
{rrr}
0.93 &amp; 0.25 \\
-0.30 &amp; 0.80 \\
0.94 &amp; 0.13 \\
-0.34 &amp; 0.79 \\
0.87 &amp; 0.35 \\
-0.18 &amp; 0.87
\end{array}\right]\]</span></p>
<p>The linear relation between the factors and the factor loadings can also be shown in a graph, where each axis represents a factor and the variables are placed on the coordinates according to the strength of the relationship between the variable and each factor. The greater the loading of variables on a factor, the more that factor explains relationships between those variables. You can also think of the factor loadings as the correlations between a factor and a variable.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-335"></span>
<img src="_main_files/figure-html/unnamed-chunk-335-1.png" alt="Factor loadings" width="672" />
<p class="caption">
Figure 8.1: Factor loadings
</p>
</div>
<p><br></p>
<p>The factor loadings may then be used to compute the two new variables (i.e., factor scores) representing the two underlying dimensions. Using a rather simplistic approach, the factor scores for person <em>i</em> could be computed by</p>
<p><span class="math display" id="eq:factor5">\[\begin{equation} 
\begin{split}
Health_i=&amp; 0.93*preventCavities_{i} -0.3*shinyTeeth_{i} + 0.94*strengthenGum_{i}\\
          &amp;-0.34*freshBreath_{i} + 0.87*preventDecay_{i} - 0.18*attractTeeth_{i}
\end{split}
\tag{8.5}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:factor6">\[\begin{equation} 
\begin{split}
Social_i=&amp; 0.25*preventCavities_{i} + 0.80*shinyTeeth_{i} + 0.13*strengthenGum_{i}\\
         &amp;+ 0.79*freshBreath_{i}+ 0.35*preventDecay_{i}+ 0.87*attractTeeth_{i}
\end{split}
\tag{8.6}
\end{equation}\]</span></p>
<p>where the variable names are replaced by the values that were observed for respondent <em>i</em> to compute the factor scores for respondent <em>i</em>. This means that we have reduced the number of variables from six to two. Note that this is a rather simple approach that is intended to explain the underlying logic. However, that the resulting factor scores will depend on the measurement scales of the variables. If different measurement scales would be used, the resulting factor scores for different factors could not be compared. Thus, R will compute the factor scores using more sophisticated methods as we will see below.</p>
</div>
<div id="steps-in-factor-analysis" class="section level2">
<h2><span class="header-section-number">8.2</span> Steps in factor analysis</h2>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="exploratory-factor-analysis.html#cb577-1"></a><span class="kw">readRDS</span>(<span class="st">&quot;music_data.rds&quot;</span>)</span></code></pre></div>
<p>Now that we have a broad understanding of how factor analysis works, let’s use another example to go through the process of deriving factors step by step. In this section, we will use Spotify data.</p>
<p>We have collected data for 48.919 songs and stored the results in the data set “music_data”.</p>
<div id="are-the-assumptions-satisfied" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Are the assumptions satisfied?</h3>
<p>Since PCA is based on the correlation between variables, the first step is to inspect the correlation matrix, which can be created using the <code>cor()</code> function.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="exploratory-factor-analysis.html#cb578-1"></a>spotify_matrix &lt;-<span class="st"> </span><span class="kw">cor</span>(music_data)</span>
<span id="cb578-2"><a href="exploratory-factor-analysis.html#cb578-2"></a><span class="kw">round</span>(spotify_matrix,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              danceability energy    key loudness   mode acousticness liveness
## danceability        1.000  0.198  0.010    0.187 -0.123       -0.247   -0.085
## energy              0.198  1.000  0.022    0.737 -0.110       -0.602    0.166
## key                 0.010  0.022  1.000    0.004 -0.161       -0.006   -0.010
## loudness            0.187  0.737  0.004    1.000 -0.065       -0.460    0.088
## mode               -0.123 -0.110 -0.161   -0.065  1.000        0.086    0.019
## acousticness       -0.247 -0.602 -0.006   -0.460  0.086        1.000   -0.070
## liveness           -0.085  0.166 -0.010    0.088  0.019       -0.070    1.000
## valence             0.369  0.402  0.031    0.271 -0.061       -0.168    0.060
## tempo              -0.084  0.094 -0.004    0.077  0.011       -0.083    0.018
##              valence  tempo
## danceability   0.369 -0.084
## energy         0.402  0.094
## key            0.031 -0.004
## loudness       0.271  0.077
## mode          -0.061  0.011
## acousticness  -0.168 -0.083
## liveness       0.060  0.018
## valence        1.000  0.037
## tempo          0.037  1.000</code></pre>
<p>If the variables measure the same construct, we would expect to see a certain degree of correlation between the variables. Even if the variables turn out to measure different dimensions of the same underlying construct, we would still expect to see some degree of correlation. So the first problem that could occur is that the <strong>correlations are not high enough</strong>. A first approach would be to scan the correlation matrix for correlations lower than about 0.3 and identify variables that have many correlations below this threshold. If your data set contains many variables, this task can be quite tedious. To make the task a little easier, you could proceed as follows.</p>
<p>Create a dataframe from the correlation matrix and set the diagonal elements to missing since these are always 1:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="exploratory-factor-analysis.html#cb580-1"></a>correlations &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(spotify_matrix)</span>
<span id="cb580-2"><a href="exploratory-factor-analysis.html#cb580-2"></a><span class="kw">diag</span>(correlations) &lt;-<span class="st"> </span><span class="ot">NA</span></span></code></pre></div>
<p>Now we can use the <code>apply()</code> function to count the number of correlations for each variable that are below a certain threshold (say, 0.3). The <code>apply()</code> function is very useful as it lets you apply function by the rows or columns in your dataframe. In the following example <code>abs(correlations) &lt; 0.3</code> returns a logical value for the correlation matrix that returns <code>TRUE</code> if the statement is true. The second argument <code>1</code> means that the function should be applied to the rows (<code>2</code> would apply it to the columns). The third argument states the function that should be applied. In our case, we would like to count the number of absolute correlations below 0.3 so we apply the <code>sum</code> function, which sums the number of <code>TRUE</code> occurrences by row. The final argument <code>na.rm = TRUE</code> simply tells R to neglect the missing values that we have created for the diagonals of the matrix.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="exploratory-factor-analysis.html#cb581-1"></a><span class="kw">apply</span>(<span class="kw">abs</span>(correlations) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dv">1</span>, sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## danceability       energy          key     loudness         mode acousticness 
##            7            5            8            6            8            6 
##     liveness      valence        tempo 
##            8            6            8</code></pre>
<p>The output shows you the number of correlations below the threshold for each variable. In a similar way, it would also be possible to compute the mean correlation for each variable.</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="exploratory-factor-analysis.html#cb583-1"></a><span class="kw">apply</span>(<span class="kw">abs</span>(correlations),<span class="dv">1</span>,mean,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## danceability       energy          key     loudness         mode acousticness 
##   0.16283732   0.29136769   0.03108516   0.23636671   0.07951326   0.21539451 
##     liveness      valence        tempo 
##   0.06474855   0.17491214   0.05117508</code></pre>
<p>Another way to make the correlations more salient is to plot the correlation matrix using different colors that indicate the strength of the correlations. This can be done using the <code>corPlot()</code> function from the <code>psych</code> package.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="exploratory-factor-analysis.html#cb585-1"></a><span class="kw">corPlot</span>(correlations,<span class="dt">numbers=</span><span class="ot">TRUE</span>,<span class="dt">upper=</span><span class="ot">FALSE</span>,<span class="dt">diag=</span><span class="ot">FALSE</span>,<span class="dt">xlas=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&quot;Correlations between variables&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-344"></span>
<img src="_main_files/figure-html/unnamed-chunk-344-1.png" alt="Correlation matrix" width="960" />
<p class="caption">
Figure 8.2: Correlation matrix
</p>
</div>
<p>You will, however, notice that this is a rather subjective approach. The <strong>Bartlett’s test</strong> is a statistical test that can be used to test whether all the off-diagonal elements in the population correlation matrix are zero (i.e., whether the population correlation matrix resembles an identify matrix). Thus, it tests whether the correlations are overall too small. If the matrix is an identify matrix, it means that all variables are independent. Thus, a significant test statistic (i.e., p &lt; 0.05) indicates that there is some relationship between variables. The test can be implemented using the <code>cortest.bartlett()</code> function from the <code>psych</code> package:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="exploratory-factor-analysis.html#cb586-1"></a><span class="kw">library</span>(psych)</span>
<span id="cb586-2"><a href="exploratory-factor-analysis.html#cb586-2"></a><span class="kw">cortest.bartlett</span>(spotify_matrix, <span class="dt">n =</span> <span class="kw">nrow</span>(music_data))</span></code></pre></div>
<pre><code>## $chisq
## [1] 85448.1
## 
## $p.value
## [1] 0
## 
## $df
## [1] 36</code></pre>
<p>In our example, the p-value is less than 0.05, which is good news since it confirms that overall the correlation between variables is different from zero.</p>
<p>The other problem that might occur is that <strong>the correlations are too high</strong>. Actually, a certain degree of multicollinearity is not a problem in PCA. However, it is important to avoid extreme multicollinearity (i.e., variables are highly correlated) and singularity (i.e., variables are perfectly correlated). Multicollinearity causes problems, because it becomes difficult to determine the unique contribution of a variable (as was the case in linear regression analysis). Again, inspecting the entire correlation matrix when there are many variables will be a tedious task. .</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="exploratory-factor-analysis.html#cb588-1"></a><span class="kw">apply</span>(<span class="kw">abs</span>(correlations) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.8</span>, <span class="dv">1</span>, sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## danceability       energy          key     loudness         mode acousticness 
##            0            0            0            0            0            0 
##     liveness      valence        tempo 
##            0            0            0</code></pre>
<p>The results do not suggest any extreme or perfect correlations. Again, there is a more objective measure that could be applied. The <strong>determinant</strong> tells us whether the correlation matrix is singular (determinant = 0), or if all variables are completely unrelated (determinant = 1), or somewhere in between. As a rule of thumb, the determinant should be greater than 0.00001. The <code>det()</code> function can be used to compute the determinant:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="exploratory-factor-analysis.html#cb590-1"></a><span class="kw">det</span>(spotify_matrix)</span></code></pre></div>
<pre><code>## [1] 0.1743137</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="exploratory-factor-analysis.html#cb592-1"></a><span class="kw">det</span>(spotify_matrix) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.00001</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>As you can see, the determinant is larger than the threshold, indicating that the overall correlation between variables is not too strong.</p>
<p>Finally, you should test if the correlation pattern in the matrix is appropriate for factor analysis using the Kaiser-Meyer-Olkin (KMO) measure of sampling adequacy. This statistic is a measure of the proportion of variance among variables that might be common variance.</p>
<p><span class="math display" id="eq:MSA">\[\begin{equation} 
MSA_j=\frac{\sum_{k\ne j}^{}{r^2_{jk}}}{\sum_{k\ne j}^{}{r^2_{jk}}+\sum_{k\ne j}^{}{p^2_{jk}}}
\tag{8.7}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(r_{jk}\)</span> is the correlation between two variables of interest and <span class="math inline">\(p_{jk}\)</span> is their partial correlation. The partial correlation measures the degree of association between the two variables, when the effect of the remaining variables is controlled for. It can take values between 0 (bad) and 1 (good), where a value of 0 indicates that the sum of partial correlations is large relative to the sum of correlations. If the remaining correlation between two variables remains high if you control for all the other variables, this provides an indication that the correlation is fairly concentrated and on a subset of the variables and factor analysis is likely to be inappropriate. In contrast, a value close to 1 means that the sum of the partial correlations is fairly low, indicating a more compact pattern of correlations between a larger set of variables. Values should at least exceed 0.50, with the thresholds:</p>
<ul>
<li>&lt;.50 = unacceptable</li>
<li>&gt;.50 = miserable</li>
<li>&gt;.60 = mediocre</li>
<li>&gt;.70 = middling</li>
<li>&gt;.80 = meritorious</li>
<li>&gt;.90 = marvelous</li>
</ul>
<p>The KMO measure of sampling adequacy can be computed using the <code>KMO()</code> function from the <code>psych</code> package:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="exploratory-factor-analysis.html#cb594-1"></a><span class="kw">KMO</span>(music_data)</span></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = music_data)
## Overall MSA =  0.64
## MSA for each item = 
## danceability       energy          key     loudness         mode acousticness 
##         0.58         0.61         0.51         0.68         0.62         0.71 
##     liveness      valence        tempo 
##         0.59         0.60         0.59</code></pre>
<p>You can see that the statistic is calculated for the entire matrix and for each variable individually. In our example, the values for all variables as well as the overall matrix is above 0.5, suggesting that factor analysis is appropriate.</p>
</div>
<div id="deriving-factors" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Deriving factors</h3>
<p>After testing that the data can be used for PCA, we can move on to conducting PCA. Conducting PCA is fairly simple in R using the <code>principal()</code> function from the <code>psych</code> package. However, before we apply the function to our data, it is useful to reflect on the goals of PCA again. The goal is to explain the maximum amount of total variance in a correlation matrix by transforming the original variables into a smaller set of linear components (factors). So the first decision we have to make is how many factors we should extract. There are different methods that can be used to decide on the appropriate number of factors, including:</p>
<ul>
<li><strong>A priori determination</strong>: Requires prior knowledge</li>
<li><strong>Determination based on percentage of variance</strong>: When cumulative percentage of variance extracted by the factors reaches a satisfactory level (e.g., factors extracted should account for at least 60% of the variance)</li>
<li><strong>Eigenvalues</strong>: Eigenvalues refer to the total variance that is explained by each factor. Factors with eigenvalues greater than 1.0 are retained (factors with a variance less than 1.0 are no better than a single variable)</li>
<li><strong>Scree plot</strong>: Is a plot of the eigenvalues against the number of factors in order of extraction. Assumption: the point at which the scree begins denotes the true number of factors.</li>
</ul>
<p>Often, the decision is made based on a combination of different criteria.</p>
<p>By extracting as many factors as there are variables we can inspect their eigenvalues and make decisions about which factors to extract. Since we have 9 variables, we set the argument <code>nfactors</code> to 9, which is equivalent to the number of columns <code>ncol</code> in our dataset.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="exploratory-factor-analysis.html#cb596-1"></a>pc1 &lt;-<span class="st"> </span><span class="kw">principal</span>(music_data, <span class="dt">nfactors =</span> <span class="kw">ncol</span>(music_data), <span class="dt">rotate =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb596-2"><a href="exploratory-factor-analysis.html#cb596-2"></a>pc1</span></code></pre></div>
<pre><code>## Principal Components Analysis
## Call: principal(r = music_data, nfactors = ncol(music_data), rotate = &quot;none&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9 h2
## danceability  0.45 -0.56 -0.39 -0.03  0.20 -0.07 -0.45  0.28  0.05  1
## energy        0.89  0.18  0.06  0.03 -0.12  0.06  0.16  0.00  0.35  1
## key           0.05 -0.40  0.69  0.08  0.12  0.58 -0.10  0.02  0.00  1
## loudness      0.80  0.19  0.03 -0.02 -0.22  0.10  0.23  0.39 -0.23  1
## mode         -0.19  0.50 -0.51 -0.01  0.12  0.64 -0.14  0.02  0.02  1
## acousticness -0.73 -0.12 -0.04  0.09  0.32 -0.01  0.40  0.40  0.13  1
## liveness      0.17  0.45  0.22  0.70  0.38 -0.19 -0.22  0.07 -0.03  1
## valence       0.57 -0.27 -0.25  0.05  0.57  0.07  0.35 -0.28 -0.09  1
## tempo         0.12  0.39  0.30 -0.69  0.47 -0.14 -0.13  0.07  0.00  1
##                                u2 com
## danceability -0.00000000000000133 4.7
## energy        0.00000000000000044 1.5
## key           0.00000000000000278 2.8
## loudness      0.00000000000000067 2.2
## mode          0.00000000000000155 3.3
## acousticness  0.00000000000000022 2.9
## liveness      0.00000000000000011 3.3
## valence       0.00000000000000000 4.2
## tempo        -0.00000000000000067 3.2
## 
##                        PC1  PC2  PC3  PC4  PC5  PC6  PC7  PC8  PC9
## SS loadings           2.58 1.24 1.10 0.98 0.91 0.83 0.66 0.48 0.21
## Proportion Var        0.29 0.14 0.12 0.11 0.10 0.09 0.07 0.05 0.02
## Cumulative Var        0.29 0.42 0.55 0.66 0.76 0.85 0.92 0.98 1.00
## Proportion Explained  0.29 0.14 0.12 0.11 0.10 0.09 0.07 0.05 0.02
## Cumulative Proportion 0.29 0.42 0.55 0.66 0.76 0.85 0.92 0.98 1.00
## 
## Mean item complexity =  3.1
## Test of the hypothesis that 9 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0 
##  with the empirical chi square  0  with prob &lt;  NA 
## 
## Fit based upon off diagonal values = 1</code></pre>
The output is quite complex, but we will focus only on the <code>SS loadings</code> for now, which are the Eigenvalues (a.k.a. sum of squared loadings). One common rule is to retain factors with eigenvalues greater than 1.0. So based on this rule, we would extract 3 factors (i.e., the SS loadings for the
<p>
4<sup>th</sup> factor is &lt; 1).
</p>
<p>You can also plot the eigenvalues against the number of factors in order of extraction using a so-called <strong>Scree plot</strong>:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="exploratory-factor-analysis.html#cb598-1"></a><span class="kw">plot</span>(pc1<span class="op">$</span>values, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb598-2"><a href="exploratory-factor-analysis.html#cb598-2"></a><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(music_data)))</span>
<span id="cb598-3"><a href="exploratory-factor-analysis.html#cb598-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb598-4"><a href="exploratory-factor-analysis.html#cb598-4"></a><span class="kw">abline</span>(<span class="dt">v=</span>nfac, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-351"></span>
<img src="_main_files/figure-html/unnamed-chunk-351-1.png" alt="Scree plot" width="672" />
<p class="caption">
Figure 8.3: Scree plot
</p>
</div>
<p>The dashed line is simply a visualization of the rule that we will retain factors with Eigenvalues &gt; 1 (suggesting 3 factors). Another criterion based on this plot would be to find the point where the curve flattens (point of inflection). If the largest few eigenvalues in the covariance matrix dominate in magnitude, then the scree plot will exhibit an “elbow”. From that point onwards, the incremental gain in explained variance is rather low. Also according to this criterion, we would extract 3 factors. Taken together, the results suggest that we should extract 3 factors.</p>
<p>Now that we know how many components we want to extract, we can rerun the analysis, specifying that number:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="exploratory-factor-analysis.html#cb599-1"></a>pc2 &lt;-<span class="st"> </span><span class="kw">principal</span>(music_data, <span class="dt">nfactors =</span> nfac, <span class="dt">rotate =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb599-2"><a href="exploratory-factor-analysis.html#cb599-2"></a>pc2</span></code></pre></div>
<pre><code>## Principal Components Analysis
## Call: principal(r = music_data, nfactors = nfac, rotate = &quot;none&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                PC1   PC2   PC3   h2   u2 com
## danceability  0.45 -0.56 -0.39 0.67 0.33 2.7
## energy        0.89  0.18  0.06 0.83 0.17 1.1
## key           0.05 -0.40  0.69 0.63 0.37 1.6
## loudness      0.80  0.19  0.03 0.68 0.32 1.1
## mode         -0.19  0.50 -0.51 0.55 0.45 2.3
## acousticness -0.73 -0.12 -0.04 0.55 0.45 1.1
## liveness      0.17  0.45  0.22 0.28 0.72 1.8
## valence       0.57 -0.27 -0.25 0.46 0.54 1.9
## tempo         0.12  0.39  0.30 0.26 0.74 2.1
## 
##                        PC1  PC2  PC3
## SS loadings           2.58 1.24 1.10
## Proportion Var        0.29 0.14 0.12
## Cumulative Var        0.29 0.42 0.55
## Proportion Explained  0.52 0.25 0.22
## Cumulative Proportion 0.52 0.78 1.00
## 
## Mean item complexity =  1.7
## Test of the hypothesis that 3 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.12 
##  with the empirical chi square  52467.02  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.7</code></pre>
<p>Now that the output is less complex, we can inspect the remaining statistics. The first part of the output is the <strong>factor matrix</strong>, which contains the factor loadings of all the variables on the 3 extracted factors (i.e., PC1, PC2, PC3). As we have said before, the <strong>factor loadings</strong> are the correlations between the variables and the factors. The factor matrix also contains the columns “h2” and “u2”. “h2” refers to the <strong>communality</strong>, which is the proportion of variance a variable shares with all the other variables being considered. This is also the proportion of variance explained by the common factors. In contrast, “u2” refers to the unique variance, which is the proportion of the variance that is unique to a particular variable. In PCA, we are primarily interested in the common variance. When the communality is very low (say &lt;.30), a variable is “quite unique” and should be removed, as it is definitely measuring “something else”. In our example, all communalities (i.e., h2) are above 0.3 so that we retain all variables.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="exploratory-factor-analysis.html#cb601-1"></a><span class="co">#pc2$communality &lt; 0.3</span></span>
<span id="cb601-2"><a href="exploratory-factor-analysis.html#cb601-2"></a><span class="kw">sum</span>(pc2<span class="op">$</span>communality <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>In our example this is not true because the communalities of “tempo” and “liveness” are smaller 0.3. For illustrative purposes we will still continue our analysis.</p>
<p>Note that there is a difference between PCA and common factor analysis. PCA focuses on the variance and aims to reproduce the total variable variance. This means that the components reflect both common and unique variance of the variables. Factor analysis, in contrast, focuses on the correlation and aims to reproduce the correlations among variables. Here, the factors only represent the common variance that variable share and do not include the unique variance. In other words, while factor analysis focuses on explaining the off-diagonal terms in the correlation matrix (i.e., shared co-variance), PCA focuses on explaining the diagonal terms (i.e., the variances). However, although PCA aims to reproduce the on-diagonal terms in the correlation matrix, it also tends to fit the off-diagonal correlations quite well. Hence, the results are often comparable. See also <a href="https://en.wikipedia.org/wiki/Principal_component_analysis#Relation_between_PCA_and_factor_analysis" target="_blank">here</a>.</p>
<p>You should also take a closer look at the residuals in order to check whether you have extracted the correct number of factors. The difference between the reproduced and the actual correlation matrices are the residuals. We can extract the residuals from our model using the <code>factor.residuals()</code> function from the <code>psych</code> package. It takes the original correlation matrix and the factor loadings as arguments:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="exploratory-factor-analysis.html#cb603-1"></a>residuals &lt;-<span class="st"> </span><span class="kw">factor.residuals</span>(spotify_matrix, pc2<span class="op">$</span>loadings)</span>
<span id="cb603-2"><a href="exploratory-factor-analysis.html#cb603-2"></a><span class="kw">round</span>(residuals,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              danceability energy    key loudness   mode acousticness liveness
## danceability        0.326 -0.081  0.031   -0.057  0.046       -0.002    0.179
## energy             -0.081  0.168  0.005   -0.015  0.007        0.073   -0.077
## key                 0.031  0.005  0.369    0.018  0.401        0.009    0.007
## loudness           -0.057 -0.015  0.018    0.318  0.012        0.150   -0.139
## mode                0.046  0.007  0.401    0.012  0.447       -0.015   -0.058
## acousticness       -0.002  0.073  0.009    0.150 -0.015        0.451    0.116
## liveness            0.179 -0.077  0.007   -0.139 -0.058        0.116    0.721
## valence            -0.138 -0.038  0.070   -0.124  0.053        0.201    0.143
## tempo               0.202 -0.103 -0.062   -0.104 -0.007        0.066   -0.247
##              valence  tempo
## danceability  -0.138  0.202
## energy        -0.038 -0.103
## key            0.070 -0.062
## loudness      -0.124 -0.104
## mode           0.053 -0.007
## acousticness   0.201  0.066
## liveness       0.143 -0.247
## valence        0.542  0.153
## tempo          0.153  0.737</code></pre>
<p>Note that the diagonal elements in the residual matrix correspond to the unique variance in each variable that cannot be explained by the factors (i.e., “u2” in the output above). For example, the proportion of unique variance for <code>danceability</code> is 0.33, which is reflected in the first cell in the residual matrix. The off-diagonal elements represent the difference between the actual correlations and the correlation based on the reproduced correlation matrix for all variable pairs. To see this, the reproduced correlation matrix could be generated by using the <code>factor.model()</code> function:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="exploratory-factor-analysis.html#cb605-1"></a>reproduced_matrix &lt;-<span class="st"> </span><span class="kw">factor.model</span>(pc2<span class="op">$</span>loadings)</span>
<span id="cb605-2"><a href="exploratory-factor-analysis.html#cb605-2"></a><span class="kw">round</span>(reproduced_matrix,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              danceability energy    key loudness   mode acousticness liveness
## danceability        0.674  0.278 -0.020    0.244 -0.169       -0.245   -0.264
## energy              0.278  0.832  0.016    0.752 -0.116       -0.675    0.244
## key                -0.020  0.016  0.631   -0.014 -0.562       -0.015   -0.018
## loudness            0.244  0.752 -0.014    0.682 -0.077       -0.610    0.227
## mode               -0.169 -0.116 -0.562   -0.077  0.553        0.101    0.078
## acousticness       -0.245 -0.675 -0.015   -0.610  0.101        0.549   -0.187
## liveness           -0.264  0.244 -0.018    0.227  0.078       -0.187    0.279
## valence             0.507  0.440 -0.039    0.395 -0.114       -0.369   -0.083
## tempo              -0.286  0.197  0.058    0.181  0.017       -0.149    0.265
##              valence  tempo
## danceability   0.507 -0.286
## energy         0.440  0.197
## key           -0.039  0.058
## loudness       0.395  0.181
## mode          -0.114  0.017
## acousticness  -0.369 -0.149
## liveness      -0.083  0.265
## valence        0.458 -0.116
## tempo         -0.116  0.263</code></pre>
<p>You can see that the reproduced correlation between the first and second variable is 0.278. From the correlation table from the beginning we know, however, that the observed correlation was 0.198. Hence, the difference between the observed and reproduced correlation is: 0.198 - 0.278 = -0.081, which corresponds to the residual of this variable pair in the residual matrix. Note that the diagonal elements in the reproduced matrix correspond to the communalities in the model summary above (i.e., “h2”).</p>
<p>A measure of fit can now be computed based on the size of the residuals. In the worst case, the residuals would be as large as the correlations in the original matrix, which would be the case if we extracted no factors at all. A measure of fit could therefore be the sum of the squared residuals divided by the sum of the squared correlations. We square the residuals to account for positive and negative deviations. <strong>Values &gt;0.90 are considered indicators of good fit.</strong> From the output above, you can see that: “Fit based upon off diagonal values = 0.7”. Thus, we conclude that the model has a middling fit.</p>
<p>You could also manually compute this statistic by summing over the squared residuals and correlations, take their ratio and subtract it from one (note that we use the <code>upper.tri()</code> function to use the upper triangle of the matrix only; this has the effect of discarding the diagonal elements and the elements below the diagonal).</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="exploratory-factor-analysis.html#cb607-1"></a>ssr &lt;-<span class="st"> </span>(<span class="kw">sum</span>(residuals[<span class="kw">upper.tri</span>((residuals))]<span class="op">^</span><span class="dv">2</span>)) <span class="co">#sum of squared residuals </span></span>
<span id="cb607-2"><a href="exploratory-factor-analysis.html#cb607-2"></a>ssc &lt;-<span class="st"> </span>(<span class="kw">sum</span>(spotify_matrix[<span class="kw">upper.tri</span>((spotify_matrix))]<span class="op">^</span><span class="dv">2</span>)) <span class="co">#sum of squared correlations</span></span>
<span id="cb607-3"><a href="exploratory-factor-analysis.html#cb607-3"></a><span class="dv">1</span><span class="op">-</span>(ssr<span class="op">/</span>ssc) <span class="co">#model fit</span></span></code></pre></div>
<pre><code>## [1] 0.7028767</code></pre>
<p>In a next step, we check the size of the residuals. <strong>If fewer residuals than 50% have absolute values greater than 0.05 the model is a good fit.</strong> This can be tested using the following code. We first convert the residuals to a matrix and select the upper triangular again to avoid duplicates. Finally, we count all occurrences where the absolute value is larger than 0.05 and divide it by the number of total observations to get the proportion.</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="exploratory-factor-analysis.html#cb609-1"></a>residuals &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(residuals[<span class="kw">upper.tri</span>((residuals))])</span>
<span id="cb609-2"><a href="exploratory-factor-analysis.html#cb609-2"></a>large_res &lt;-<span class="st"> </span><span class="kw">abs</span>(residuals) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb609-3"><a href="exploratory-factor-analysis.html#cb609-3"></a><span class="kw">sum</span>(large_res)</span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="exploratory-factor-analysis.html#cb611-1"></a><span class="kw">sum</span>(large_res)<span class="op">/</span><span class="kw">nrow</span>(residuals)</span></code></pre></div>
<pre><code>## [1] 0.6388889</code></pre>
<p>In our example, we cannot confirm that the proportion of residuals &gt; 0.05 is less than 50%.</p>
<p>Another way to evaluate the residuals is by looking at their mean value (rather, we square the residuals first to account for positive and negative values, compute the mean and then take the square root).</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="exploratory-factor-analysis.html#cb613-1"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>(residuals<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.1220501</code></pre>
<p>This means that our mean residual is 0.1221 and this value should be as low as possible.</p>
<p>Finally, we need to validate if the residuals are approximately normally distributed, which we do by using a histogram, a Q-Q plot and the Shapiro test.</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="exploratory-factor-analysis.html#cb615-1"></a><span class="kw">hist</span>(residuals)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-361"></span>
<img src="_main_files/figure-html/unnamed-chunk-361-1.png" alt="Histogram of residuals" width="672" />
<p class="caption">
Figure 8.4: Histogram of residuals
</p>
</div>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="exploratory-factor-analysis.html#cb616-1"></a><span class="kw">qqnorm</span>(residuals) </span>
<span id="cb616-2"><a href="exploratory-factor-analysis.html#cb616-2"></a><span class="kw">qqline</span>(residuals)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-362"></span>
<img src="_main_files/figure-html/unnamed-chunk-362-1.png" alt="Q-Q plot" width="672" />
<p class="caption">
Figure 8.5: Q-Q plot
</p>
</div>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="exploratory-factor-analysis.html#cb617-1"></a><span class="kw">shapiro.test</span>(residuals)</span></code></pre></div>
<pre><code>## 
## 	Shapiro-Wilk normality test
## 
## data:  residuals
## W = 0.96007, p-value = 0.2161</code></pre>
<p>All of the tests suggest that the distribution of the residuals is approximately normal.</p>
</div>
<div id="factor-interpretation" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Factor interpretation</h3>
<p>To aid interpretation, it is possible to maximize the loading of a variable on one factor while minimizing its loading on all other factors. This is known as factor rotation. There are two types of factor rotation:</p>
<ul>
<li>orthogonal (assumes that factors are uncorrelated)</li>
<li>oblique (assumes that factors are intercorrelated)</li>
</ul>
<p>To carry out a orthogonal rotation, we change the rotate option in the <code>principal()</code> function from “none” to “varimax” (we could also exclude it altogether because varimax is the default if the option is not specified):</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="exploratory-factor-analysis.html#cb619-1"></a>pc3 &lt;-<span class="st"> </span><span class="kw">principal</span>(music_data, <span class="dt">nfactors =</span> nfac, <span class="dt">rotate =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb619-2"><a href="exploratory-factor-analysis.html#cb619-2"></a>pc3</span></code></pre></div>
<pre><code>## Principal Components Analysis
## Call: principal(r = music_data, nfactors = nfac, rotate = &quot;varimax&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                RC1   RC2   RC3   h2   u2 com
## danceability  0.42 -0.70  0.06 0.67 0.33 1.7
## energy        0.90  0.15  0.05 0.83 0.17 1.1
## key          -0.04  0.07  0.79 0.63 0.37 1.0
## loudness      0.81  0.14  0.01 0.68 0.32 1.1
## mode         -0.11  0.12 -0.73 0.55 0.45 1.1
## acousticness -0.73 -0.09 -0.05 0.55 0.45 1.0
## liveness      0.19  0.49 -0.06 0.28 0.72 1.3
## valence       0.55 -0.39  0.01 0.46 0.54 1.8
## tempo         0.14  0.49  0.03 0.26 0.74 1.2
## 
##                        RC1  RC2  RC3
## SS loadings           2.56 1.20 1.17
## Proportion Var        0.28 0.13 0.13
## Cumulative Var        0.28 0.42 0.55
## Proportion Explained  0.52 0.24 0.24
## Cumulative Proportion 0.52 0.76 1.00
## 
## Mean item complexity =  1.2
## Test of the hypothesis that 3 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.12 
##  with the empirical chi square  52467.02  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.7</code></pre>
<p>Interpreting the factor loading matrix is a little complex, so we can make it easier by using the <code>print.psych()</code> function, which we can use to exclude loading below a cutoff from the display and order the variables by their loading within each factor. In the following, we will only display loadings that exceed the value 0.3.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="exploratory-factor-analysis.html#cb621-1"></a><span class="kw">print.psych</span>(pc3, <span class="dt">cut =</span> <span class="fl">0.3</span>, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Principal Components Analysis
## Call: principal(r = music_data, nfactors = nfac, rotate = &quot;varimax&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##              item   RC1   RC2   RC3   h2   u2 com
## energy          2  0.90             0.83 0.17 1.1
## loudness        4  0.81             0.68 0.32 1.1
## acousticness    6 -0.73             0.55 0.45 1.0
## valence         8  0.55 -0.39       0.46 0.54 1.8
## danceability    1  0.42 -0.70       0.67 0.33 1.7
## tempo           9        0.49       0.26 0.74 1.2
## liveness        7        0.49       0.28 0.72 1.3
## key             3              0.79 0.63 0.37 1.0
## mode            5             -0.73 0.55 0.45 1.1
## 
##                        RC1  RC2  RC3
## SS loadings           2.56 1.20 1.17
## Proportion Var        0.28 0.13 0.13
## Cumulative Var        0.28 0.42 0.55
## Proportion Explained  0.52 0.24 0.24
## Cumulative Proportion 0.52 0.76 1.00
## 
## Mean item complexity =  1.2
## Test of the hypothesis that 3 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.12 
##  with the empirical chi square  52467.02  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.7</code></pre>
<p>After obtaining the rotated matrix, variables with high loading are used for interpreting (=naming) the factor. Note that factor loading can be positive or negative (depends on scaling of the variable), thus take care when interpreting! Look for simple structure: each variable (hopefully) loads high on 1 factor and low on other factors.</p>
<p>As an example, we could name our factors as follows:</p>
<ul>
<li><strong>Factor 1:</strong> energetic</li>
<li><strong>Factor 2:</strong> fast</li>
<li><strong>Factor 3:</strong> pitch</li>
</ul>
<p>The previous type of rotation (i.e., “varimax”) assumed that the factors are independent. Oblique rotation is another type of rotation that can handle correlation between the factors. The command for an oblique rotation is very similar to that for an orthogonal rotation – we just change the rotate option from “varimax” to “oblimin”.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="exploratory-factor-analysis.html#cb623-1"></a>pc4 &lt;-<span class="st"> </span><span class="kw">principal</span>(music_data, <span class="dt">nfactors =</span> nfac, <span class="dt">rotate =</span> <span class="st">&quot;oblimin&quot;</span>, <span class="dt">scores =</span> <span class="ot">TRUE</span>)</span>
<span id="cb623-2"><a href="exploratory-factor-analysis.html#cb623-2"></a><span class="kw">print.psych</span>(pc4, <span class="dt">cut =</span> <span class="fl">0.3</span>, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Principal Components Analysis
## Call: principal(r = music_data, nfactors = nfac, rotate = &quot;oblimin&quot;, 
##     scores = TRUE)
## Standardized loadings (pattern matrix) based upon correlation matrix
##              item   TC1   TC2   TC3   h2   u2 com
## energy          2  0.91             0.83 0.17 1.0
## loudness        4  0.82             0.68 0.32 1.0
## acousticness    6 -0.73             0.55 0.45 1.0
## danceability    1        0.79       0.67 0.33 1.0
## valence         8  0.36  0.50       0.46 0.54 1.8
## tempo           9  0.33 -0.47       0.26 0.74 1.8
## liveness        7  0.39 -0.46       0.28 0.72 2.0
## key             3              0.80 0.63 0.37 1.0
## mode            5             -0.72 0.55 0.45 1.1
## 
##                        TC1  TC2  TC3
## SS loadings           2.43 1.33 1.16
## Proportion Var        0.27 0.15 0.13
## Cumulative Var        0.27 0.42 0.55
## Proportion Explained  0.49 0.27 0.24
## Cumulative Proportion 0.49 0.76 1.00
## 
##  With component correlations of 
##      TC1  TC2  TC3
## TC1 1.00 0.23 0.06
## TC2 0.23 1.00 0.07
## TC3 0.06 0.07 1.00
## 
## Mean item complexity =  1.3
## Test of the hypothesis that 3 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.12 
##  with the empirical chi square  52467.02  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.7</code></pre>
<p>The component correlations indicate that the factors are not correlated, therefore orthogonal rotation is appropriate.</p>
</div>
<div id="creating-new-variables" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Creating new variables</h3>
<p>Once we have decided on the final model, we can calculate the new variables as the weighted sum of the variables that form a factor. This means, we estimate a person’s score on a factor based on their scores on the items that constitute the measurement scales. These scores are also referred to as the <strong>factor scores</strong>. Because we have used the <code>scores = TRUE</code> argument in the previous command, the factor scores have already been created for us. By default, R uses the regression method to compute the factor scores, which controls for differences in the units of measurement. You can access the residuals as follows:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="exploratory-factor-analysis.html#cb625-1"></a><span class="kw">head</span>(pc4<span class="op">$</span>scores)</span></code></pre></div>
<pre><code>##             TC1        TC2         TC3
## [1,]  0.2790735 -0.6352026 -0.09713790
## [2,] -0.3402132  0.9864093 -0.08629953
## [3,]  0.5673092 -2.2430912  0.16181608
## [4,]  0.5118725  0.9366503  1.34593205
## [5,]  0.4376880  0.2085055 -1.40321622
## [6,] -0.2050096  1.0838175  1.45112640</code></pre>
<p>We can also use the <code>cbind()</code> function to add the computed factor scores to the existing data set:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="exploratory-factor-analysis.html#cb627-1"></a>music_data &lt;-<span class="st"> </span><span class="kw">cbind</span>(music_data, pc4<span class="op">$</span>scores)</span></code></pre></div>
<p>This way, it is easier to use the new variables in subsequent analysis (e.g., t-tests, regression, ANOVA, cluster analysis).</p>
</div>
</div>
<div id="reliability-analysis" class="section level2">
<h2><span class="header-section-number">8.3</span> Reliability analysis</h2>
<p>When you are using multi-item scales to measure a latent construct (e.g., the output from the PCA above), it is useful to check the reliability of your scale. Reliability means that our items should consistently reflect the construct that they are intended to measure. In other words, individual items should produce results consistent with the overall scale. This means that for a scale to be reliable, the score of a person on one half of the items should be similar to the score derived based on the other half of the items (split-half reliability). The problem is that there are several ways in which data can be split. A measure that reflects this underlying intuition is <strong>Cronbach’s alpha</strong>, which is approximately equal to the average of all possible split-half reliabilities. It is computed as follows:</p>
<p><span class="math display" id="eq:calpha">\[\begin{equation} 
\alpha=\frac{N^2\overline{Cov}}{\sum{s^2_{item}}+\sum{Cov_{item}}}
\tag{8.8}
\end{equation}\]</span></p>
<p>The share of the items common variance (inter-correlation) in the total variance is supposed to be as high as possible across all items. The thresholds are as follows:</p>
<ul>
<li>&gt;0.7 reasonable for practical application/explorative research</li>
<li>&gt;0.8 necessary for fundamental research</li>
<li>&gt;0.9 desirable for applied research</li>
</ul>
<p>To see if the subscales that were derived from the previous PCA exhibit a sufficient degree of reliability, we first create subsets of our data set that contain the respective items for each of the factors (we use the results from the oblimin rotation here):</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="exploratory-factor-analysis.html#cb628-1"></a>energetic &lt;-<span class="st"> </span>music_data[,<span class="kw">c</span>(rc1)]</span>
<span id="cb628-2"><a href="exploratory-factor-analysis.html#cb628-2"></a>pitch &lt;-<span class="st"> </span>music_data[,<span class="kw">c</span>(rc3)]</span>
<span id="cb628-3"><a href="exploratory-factor-analysis.html#cb628-3"></a>dancefloor &lt;-<span class="st"> </span>music_data[,<span class="kw">c</span>(rc2)]</span></code></pre></div>
<p>Now we can use the <code>alpha()</code> function from the <code>psych</code> package to test the reliability. Note that the <code>keys</code> argument may be used to indicate reverse coded items.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="exploratory-factor-analysis.html#cb629-1"></a>psych<span class="op">::</span><span class="kw">alpha</span>(energetic, <span class="dt">check.keys=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = energetic, check.keys = TRUE)
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
##       0.26      0.74    0.76      0.36 2.9 0.0013  -13 0.64     0.32
## 
##  lower alpha upper     95% confidence boundaries
## 0.26 0.26 0.26 
## 
##  Reliability if an item is dropped:
##               raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
## danceability       0.25      0.76    0.76      0.44 3.1   0.0012 0.044  0.43
## energy             0.18      0.61    0.57      0.28 1.6   0.0013 0.013  0.26
## loudness           0.65      0.66    0.66      0.33 2.0   0.0025 0.026  0.31
## acousticness-      0.19      0.69    0.70      0.36 2.3   0.0012 0.042  0.32
## valence            0.23      0.73    0.73      0.41 2.7   0.0011 0.054  0.35
## 
##  Item statistics 
##                   n raw.r std.r r.cor r.drop   mean   sd
## danceability  48919  0.27  0.57  0.39   0.23   0.65 0.15
## energy        48919  0.79  0.84  0.85   0.77   0.64 0.18
## loudness      48919  0.99  0.76  0.72   0.59  -6.85 2.82
## acousticness- 48919  0.55  0.71  0.61   0.48 -58.64 0.26
## valence       48919  0.36  0.63  0.48   0.30   0.50 0.23</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="exploratory-factor-analysis.html#cb631-1"></a><span class="co">#psych::alpha(pitch, check.keys=TRUE)</span></span>
<span id="cb631-2"><a href="exploratory-factor-analysis.html#cb631-2"></a>psych<span class="op">::</span><span class="kw">alpha</span>(dancefloor, <span class="dt">check.keys=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = dancefloor, check.keys = TRUE)
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N     ase mean  sd median_r
##    0.00067      0.25    0.25     0.076 0.33 0.00015   86 7.1    0.051
## 
##  lower alpha upper     95% confidence boundaries
## 0 0 0 
## 
##  Reliability if an item is dropped:
##              raw_alpha std.alpha G6(smc) average_r    S/N alpha se  var.r
## danceability  -0.00062    -0.083  -0.052    -0.026 -0.077  0.00013 0.0016
## liveness-      0.00048     0.326   0.295     0.139  0.483  0.00015 0.0435
## valence        0.00161     0.166   0.119     0.062  0.199  0.00010 0.0015
## tempo-         0.31124     0.312   0.289     0.131  0.453  0.00503 0.0477
##               med.r
## danceability -0.037
## liveness-     0.084
## valence       0.084
## tempo-        0.085
## 
##  Item statistics 
##                  n  raw.r std.r r.cor r.drop   mean    sd
## danceability 48919  0.093  0.69 0.621  0.087   0.65  0.15
## liveness-    48919  0.023  0.47 0.053  0.018 232.51  0.14
## valence      48919 -0.027  0.57 0.376 -0.035   0.50  0.23
## tempo-       48919  1.000  0.48 0.069  0.019 111.38 28.21</code></pre>
<p>The above output would lead us to conclude that the fear of computers, fear of statistics and fear of maths subscales of the RAQ all had sufficiently high reliabilities (i.e., Cronbach’s alpha &gt; 0.70). However, the fear of negative peer evaluation subscale had relatively low reliability (Cronbach’s alpha = 0.57). As the output under “Reliability if an item is dropped” suggests, the alpha score would also not increase if an item was dropped from the scale.</p>
<p>As another example, consider the multi-item scale from the statistical ability questionnaire.</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="exploratory-factor-analysis.html#cb633-1"></a>test_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/Teaching/master/MRDA2017/survey2017.dat&quot;</span>, </span>
<span id="cb633-2"><a href="exploratory-factor-analysis.html#cb633-2"></a>                        <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb633-3"><a href="exploratory-factor-analysis.html#cb633-3"></a><span class="kw">head</span>(test_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["startdate"],"name":[1],"type":["chr"],"align":["left"]},{"label":["enddate"],"name":[2],"type":["chr"],"align":["left"]},{"label":["ipaddress"],"name":[3],"type":["chr"],"align":["left"]},{"label":["duration"],"name":[4],"type":["int"],"align":["right"]},{"label":["experience"],"name":[5],"type":["int"],"align":["right"]},{"label":["theory_ht"],"name":[6],"type":["int"],"align":["right"]},{"label":["theory_anova"],"name":[7],"type":["int"],"align":["right"]},{"label":["theory_reg"],"name":[8],"type":["int"],"align":["right"]},{"label":["theory_fa"],"name":[9],"type":["int"],"align":["right"]},{"label":["pract_ht"],"name":[10],"type":["int"],"align":["right"]},{"label":["pract_anova"],"name":[11],"type":["int"],"align":["right"]},{"label":["pract_reg"],"name":[12],"type":["int"],"align":["right"]},{"label":["pract_fa"],"name":[13],"type":["int"],"align":["right"]},{"label":["overall_knowledge"],"name":[14],"type":["int"],"align":["right"]},{"label":["multi_1"],"name":[15],"type":["int"],"align":["right"]},{"label":["multi_2"],"name":[16],"type":["int"],"align":["right"]},{"label":["multi_3"],"name":[17],"type":["int"],"align":["right"]},{"label":["multi_4"],"name":[18],"type":["int"],"align":["right"]},{"label":["overall_100"],"name":[19],"type":["int"],"align":["right"]},{"label":["prior_SPSS"],"name":[20],"type":["int"],"align":["right"]},{"label":["prior_R"],"name":[21],"type":["int"],"align":["right"]},{"label":["prior_Stata"],"name":[22],"type":["int"],"align":["right"]},{"label":["prior_Excel"],"name":[23],"type":["int"],"align":["right"]},{"label":["prior_SAS"],"name":[24],"type":["int"],"align":["right"]},{"label":["software_preference"],"name":[25],"type":["int"],"align":["right"]},{"label":["future_importance"],"name":[26],"type":["int"],"align":["right"]},{"label":["gender"],"name":[27],"type":["int"],"align":["right"]},{"label":["country"],"name":[28],"type":["int"],"align":["right"]},{"label":["group"],"name":[29],"type":["int"],"align":["right"]},{"label":["lat"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["long"],"name":[31],"type":["dbl"],"align":["right"]}],"data":[{"1":"04.09.2017 21:03","2":"04.09.2017 21:05","3":"188.23.190.194","4":"136","5":"3","6":"2","7":"2","8":"2","9":"2","10":"3","11":"3","12":"3","13":"3","14":"2","15":"2","16":"2","17":"4","18":"3","19":"25","20":"1","21":"1","22":"1","23":"5","24":"1","25":"5","26":"4","27":"1","28":"1","29":"1","30":"48.30000","31":"16.350006"},{"1":"04.09.2017 21:07","2":"04.09.2017 21:12","3":"93.10.250.2","4":"297","5":"3","6":"1","7":"3","8":"3","9":"3","10":"1","11":"1","12":"1","13":"1","14":"2","15":"2","16":"2","17":"2","18":"4","19":"15","20":"1","21":"1","22":"1","23":"4","24":"1","25":"5","26":"4","27":"2","28":"2","29":"1","30":"43.71671","31":"7.366699"},{"1":"04.09.2017 21:09","2":"04.09.2017 21:13","3":"91.0.18.86","4":"237","5":"3","6":"2","7":"3","8":"3","9":"1","10":"1","11":"1","12":"1","13":"1","14":"2","15":"3","16":"3","17":"3","18":"3","19":"30","20":"1","21":"1","22":"1","23":"2","24":"1","25":"5","26":"4","27":"2","28":"2","29":"2","30":"50.91330","31":"6.815201"},{"1":"04.09.2017 21:14","2":"04.09.2017 21:23","3":"37.116.255.55","4":"579","5":"1","6":"3","7":"3","8":"3","9":"2","10":"3","11":"3","12":"2","13":"2","14":"3","15":"4","16":"3","17":"3","18":"2","19":"65","20":"1","21":"1","22":"1","23":"3","24":"1","25":"3","26":"4","27":"2","28":"2","29":"1","30":"45.50000","31":"11.399994"},{"1":"04.09.2017 21:25","2":"04.09.2017 21:30","3":"178.165.131.208","4":"290","5":"1","6":"3","7":"3","8":"2","9":"2","10":"5","11":"5","12":"4","13":"3","14":"3","15":"4","16":"3","17":"4","18":"2","19":"70","20":"3","21":"1","22":"1","23":"3","24":"1","25":"1","26":"4","27":"2","28":"1","29":"1","30":"48.20869","31":"16.240707"},{"1":"04.09.2017 21:42","2":"04.09.2017 21:46","3":"212.28.68.81","4":"205","5":"3","6":"2","7":"3","8":"3","9":"1","10":"1","11":"1","12":"1","13":"1","14":"1","15":"3","16":"3","17":"2","18":"4","19":"0","20":"1","21":"1","22":"1","23":"1","24":"1","25":"5","26":"4","27":"2","28":"2","29":"1","30":"47.00560","31":"28.857498"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The four variables “multi_1” - “multi_4” represent the multi-item scales. We can test the reliability of the scale using the <code>alpha()</code> function (item 4 was reverse coded, hence the “-1” in the <code>keys</code> vector):</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="exploratory-factor-analysis.html#cb634-1"></a>psych<span class="op">::</span><span class="kw">alpha</span>(test_data[,<span class="kw">c</span>(<span class="st">&quot;multi_1&quot;</span>,<span class="st">&quot;multi_2&quot;</span>,<span class="st">&quot;multi_3&quot;</span>,<span class="st">&quot;multi_4&quot;</span>)], <span class="dt">keys=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = test_data[, c(&quot;multi_1&quot;, &quot;multi_2&quot;, &quot;multi_3&quot;, 
##     &quot;multi_4&quot;)], keys = c(1, 1, 1, -1))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N   ase mean   sd median_r
##        0.9       0.9    0.88      0.68 8.7 0.024  2.7 0.92     0.65
## 
##  lower alpha upper     95% confidence boundaries
## 0.85 0.9 0.94 
## 
##  Reliability if an item is dropped:
##          raw_alpha std.alpha G6(smc) average_r  S/N alpha se  var.r med.r
## multi_1       0.85      0.86    0.81      0.66  5.9    0.035 0.0101  0.61
## multi_2       0.83      0.83    0.77      0.63  5.0    0.039 0.0028  0.61
## multi_3       0.86      0.86    0.83      0.68  6.3    0.034 0.0195  0.61
## multi_4-      0.91      0.91    0.88      0.77 10.0    0.022 0.0058  0.78
## 
##  Item statistics 
##           n raw.r std.r r.cor r.drop mean  sd
## multi_1  55  0.89  0.89  0.86   0.80  2.7 1.0
## multi_2  55  0.92  0.92  0.92   0.85  2.6 1.0
## multi_3  55  0.88  0.88  0.83   0.78  2.5 1.1
## multi_4- 55  0.81  0.80  0.68   0.65  2.8 1.1
## 
## Non missing response frequency for each item
##            1    2    3    4    5 miss
## multi_1 0.11 0.36 0.25 0.25 0.02    0
## multi_2 0.11 0.42 0.25 0.18 0.04    0
## multi_3 0.18 0.38 0.22 0.20 0.02    0
## multi_4 0.04 0.31 0.16 0.40 0.09    0</code></pre>
<p>Since the scale exhibits a sufficient degree of reliability, we can compute the new variable as the average score on these items. However, before doing this, we need to recode the reverse coded variable in the appropriate way. It is easy to recode the reverse coded item to be in line with the remaining items on the dimension using the <code>recode()</code> function from the <code>car</code> package.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="exploratory-factor-analysis.html#cb636-1"></a><span class="kw">library</span>(car)</span>
<span id="cb636-2"><a href="exploratory-factor-analysis.html#cb636-2"></a>test_data<span class="op">$</span>multi_<span class="dv">4</span>_rec =<span class="st"> </span><span class="kw">recode</span>(test_data<span class="op">$</span>multi_<span class="dv">4</span>, <span class="st">&quot;1=5; 2=4; 3=3; 4=2; 5=1&quot;</span>)</span></code></pre></div>
<p>Now we can compute the new variable as the average score of the four items:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="exploratory-factor-analysis.html#cb637-1"></a><span class="kw">library</span>(car)</span>
<span id="cb637-2"><a href="exploratory-factor-analysis.html#cb637-2"></a>test_data<span class="op">$</span>new_variable =<span class="st"> </span>(test_data<span class="op">$</span>multi_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">4</span>_rec) <span class="op">/</span><span class="st"> </span><span class="dv">4</span></span></code></pre></div>
</div>
<div id="summary-of-factor-analysis" class="section level2">
<h2><span class="header-section-number">8.4</span> Summary of factor analysis</h2>
<ul>
<li><p>Factor analysis belongs to a class of procedures used for data reduction. The basic assumption behind factor analysis is that for the set of observed variables there is a set of underlying variables (“factors”) that has smaller number of variables and can explain the relationships among variables.</p></li>
<li><p>Factor analysis can be divided in exploratory and confirmatory.
An exploratory factor analysis explores the relationships among the variables and does not require an a-priori fixed number of underlying factors to be given. One can have a good guess about what are the underlying factors behind the large set of variables, but still aims to form a specific hypothesis about it. <strong>Principal Components Analysis (PCA)</strong> is one of the most frequently used techniques of this sort. On the other hand, a confirmatory factor analysis requires a firm idea about the number of underlying variables.</p></li>
<li><p>Main goals of PCA:</p>
<ul>
<li>Identification of underlying dimensions, or factors, that explain the correlations among a set of variables.</li>
<li>Identification a new, smaller set of uncorrelated variables to replace the original set of correlated variables in subsequent multivariate analysis.</li>
</ul></li>
<li><p>Sequence of steps in PCA. First, we inspect the correlation matrix because, if the variables measure the same construct, we would expect to see a certain degree of correlation between the variables. However, we use <strong>Barttlet’s test</strong> to be certain weather the correlations are overall too small. At this point we can face two issues: too high correlation and too low correlation between variables. Too high correlation indicates possible extreme multicollinearity, while too low correlation suggests that variables do not indicate the same underlying construct. As an addtional tool for checking any extreme or perfect correlations, we can use <strong>determinant</strong>. It tells us whether the correlation matrix is singular (determinant = 0), or if all variables are completely unrelated (determinant = 1), or somewhere in between. Finally, we need to test if the correlation pattern in the matrix is appropriate for factor analysis using the <strong>Kaiser-Meyer-Olkin (KMO)</strong> measure of sampling adequacy. This statistic is a measure of the proportion of variance among variables that might be common variance.</p></li>
<li><p>Second step in PCA is deriving factors. There are different methods used for making a decision on the appropriate number of factors:</p>
<ul>
<li>A priori determination</li>
<li>Determination based on percentage of variance</li>
<li>Method based on Eigenvalues</li>
<li>Method based on a scree plot</li>
</ul></li>
<li><p>After we decide on the appropriate number of factors, we inspect a factor loadings in a factor matrix. More specifically, we take a closer look at <strong>communality</strong>, which is the proportion of variance a variable shares with all the other variables being considered. When the communality is very low (e.g. &lt;.30), a variable is “quite unique” and should be removed, as it is certainly measuring “something else”. Finally, in order to double-check whether we extracted the correct number of factors, we check residuals. The difference between the reproduced and the actual correlation matrices are the residuals. A measure of fit can be computed based on the size of the residuals. More specifically, a measure of fit could be the sum of the squared residuals (to account for possitve and negative deviations) divided by the sum of the squared correlations. Values &gt;0.90 are considered indicators of good fit. In a next step, we check the size of the residuals. If fewer residuals than 50% have absolute values greater than 0.05 the model is a good fit. Finally, we need to validate if the residuals are approximately normally distributed, which we do by using a histogram, a Q-Q plot and the Shapiro test.</p></li>
<li><p>What comes next is a factor interpretation. To make an interpretation more convenient, we do <strong>a factor rotation</strong>. It means maximizing the loading of a variable on one factor while minimizing its loading on all other factors. We differ two types of factor rotation:</p>
<ul>
<li>orthogonal (assumes that factors are uncorrelated)</li>
<li>oblique (assumes that factors are intercorrelated)</li>
</ul></li>
<li><p>After obtaining the rotated matrix, variables with high loading are used for naming the factor. It is important to note that factor loadings can be positive or negative, so we need to be careful when interpreting! In the best case scenario, each variable loads high on 1 factor and low on other factors.</p></li>
<li><p>When you are using multi-item scales to measure a latent construct, it is necessary to check <strong>reliability</strong> of scale. Reliability means that items should consistently reflect the construct that they are intended to measure. For that we can use <strong>Cronbach’s alpha</strong>, which calculates the share itmes common variance in the total variance. The share of the items common variance (inter-correlation) in the total variance is supposed to be as high as possible across all items.</p></li>
</ul>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
